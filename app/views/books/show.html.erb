<%- model_class = Book -%>
<%= nav_bar :fluid => :top, :brand => @book.title.titleize, :responsive => true do %>
  <%= menu_group :pull => :right do %>
    <%= drop_down_with_submenu "Actions" do %>
      <% if ( user_signed_in? && @book.is_active? ) %>
        <%= menu_item 'Add Review', new_book_review_path(@book.id) %>
        <% if ( !is_followed?(@book.id) ) %>
          <%= menu_item 'Follow', follow_book_path(@book) %>
        <% else %>
          <%= menu_item 'Stop Following', stop_following_book_path(@book) %>
        <% end %>
      <% end %>
      <% if ( ( is_admin? || is_owner?(@book)) ) %>
      <%= drop_down_divider %>
        <%= menu_item t('.edit', :default => t("helpers.links.edit")), edit_book_path(@book) %>
        <% if ( @book.reviews.empty? ) %>
          <%= menu_item t('.destroy', :default => t("helpers.links.destroy")), book_path(@book),
                    :method => 'delete',
                    :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) } %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
<div class="row-fluid">
  <div class="span4">
    <dl class="dl-horizontal">
      <dt><strong><%= model_class.human_attribute_name(:title) %>:</strong></dt>
      <dd><%= @book.title %></dd>
      <dt><strong><%= model_class.human_attribute_name(:author) %>:</strong></dt>
      <dd><%= @book.author %></dd>
      <dt><strong><%= model_class.human_attribute_name(:isbn) %>:</strong></dt>
      <dd><%= @book.isbn %></dd>
      <dt><strong><%= model_class.human_attribute_name(:avg_rating) %>:</strong></dt>
      <dd><%= @book.avg_rating %></dd>
    </dl>
  </div>
  <div class="span6">
    <dl class="dl-horizontal">
      <dd><%= image_tag(@book.image_url, class: "img") if @book.image? %></dd>
    </dl>
  </div>
</div>

<div class="row-fluid">
  <%= link_to t('.back', :default => t("helpers.links.back")),
            books_path, :class => 'btn btn-mini'  %>

  <div class="page-header">
  </div>
  <% if ( !@book.reviews.empty? ) %>
    <div class="row-fluid">
      <%= render "reviews" %>
    </div>
  <% end %>
</div>

